# tableau-practice-questions1124

#### 練習問題11

あるホテルの予約情報を含むデータから、ホテルの種類ごとに到着月別の宿泊率を比較するビジュアル表現を作成しましょう。  

・「Arrival Date Month」（到着月）ごとに、宿泊率を100%帯グラフで表示  
・宿泊率は、「Is Canceled」（キャンセルしたか）を使用して、「キャンセルしなかった割合」として計算  
・「Hotel」（ホテルの種類）ごとに表示  

##### 解答

1. まず、棒グラフを作成します。表を参考にグラフを作成します。  

［列］	［Hotel］、［カウント（1.11_hotel_bookings.csv）］  
［行］	［Arrival Date Month］  
［マーク］カードの［色］	［Is Canceled］  

※練習問題2の 4. から 7. を参照 → ［Is Canceled］をメジャーからディメンションへ移動

2. 次に、100％積み上げグラフに変更します。［列］の［カウント（1.11_hotel_bookings.csv）］を右クリックし、［簡易表計算］→［合計に対する割合］をクリックします。  
3. ［列］の［カウント（1.11_hotel_bookings.csv）］を右クリックし、［次を使用して計算］→［Is Canceled］をクリックします。  
4. 横軸を非表示にします。［列］の［カウント（1.11_hotel_bookings.csv）］を右クリックし、［ヘッダーの表示］をクリックしてチェックを外します。
5. 宿泊とキャンセルを左右逆に配置します。画面の右側にある色の凡例で項目をドラッグし、キャンセルを下、宿泊を上にします。
6. ［マーク］カードの［色］＞［色の編集］をクリックして、色を変更します。この図では、キャンセルの色を変更の際に、［キャンセル］の文字をダブルクリックして白色を選択しています。
7. ［OK］をクリックして画面を閉じます
8. ［マーク］カードの［色］をクリックして、枠線の色を変更します。
10. 割合を棒の中に表示します。［列］の［カウント（1.11_hotel_bookings.csv）］を［Ctrl］キーを押しながら［マーク］カードの［ラベル］にドロップします。割合が表示されない場合は、ビューの表示領域が狭い可能性があります。［ビュー全体］を選んでビューのサイズを調整したり、棒の幅を広げてみてください。

##### ポイント

<疑問>  
ホテルCSVを列に置くと何故シティホテルとリゾートホテルに自動的で分かれたのか？    
→CSVの構造が解っていなかったから  

##### ファイルの構造を理解する方法  
✅ Tableauで「構造」を一瞬で把握する方法（実務で一番使う）  

🔹 方法①：データソース画面を見る（最重要）  

Tableau下部の👉 ［データソース］タブ  
ここで：列名一覧/データ型（文字・数値・日付）/サンプル値  
が一気に見えます。

🔹 方法②：ディメンションをフィルターに置く  

たとえば hotel をフィルターに置くと：  
☑ City Hotel  
☑ Resort Hotel  
→ この列は カテゴリ分類用 と即判断できます。 

🔹 方法③：件数を棒グラフにする  

hotel を列、件数 を行に置くだけで：  
→ データの偏り・構造が一瞬でわかります。

<img width="1305" height="821" alt="スクリーンショット 2026-01-22 115105" src="https://github.com/user-attachments/assets/733786a4-2877-40af-bada-62ea13ed8dc9" />


#### 練習問題12

曲ごとに集計されたSpotifyのデータを使用し、ブルースとヒップホップの音楽ジャンルについて、人気スコアの分布を比較する次のようなビジュアル表現を作成しましょう。  

・「Popularity」（人気スコア）の割合の分布をエリアチャートで表示  
・「Popularity」は5%ごとにビンで集計  
・「blues」（ブルース）と「hiphop」（ヒップホップ）の各チャートを重ねて表示  

##### 解答

1. まず、2 つのデータを縦に組み合わせて 1 つのデータにします。
　フォルダ「1.12_music」にある［1.12_blues_music.csv］に接続します。  

2. 左側のペインから［1.12_hiphop_music.csv］をキャンバスの  
　［1.12_blues_music.csv］の下にドラッグし、［ユニオン］が表示されたらドロップします。  

3. ファイル名から音楽種類の文字を抜き出します。データグリッドの右端にある［テーブル名］を右クリックし、［分割］をクリックします。この［テーブル名］フィールドは、ユニオンしたことで自動的に追加されました。  

4. ［テーブル名－分割済み 1］のフィールド名をダブルクリックして、
　「ジャンル」に名前を変更します。  

5. Popularity を 5 ずつにビンでまとめます。［シート］に移動し、［データ］ペインの［Popularity］を右クリックし、［作成］→［ビン］をクリックします。  

6. ［ビンのサイズ］に「5」を入力します。  

7. ［OK］をクリックして画面を閉じます。  

［列］：［Popularity（ビン）］  
［行］：［カウント（1.12_blues_music.csv）］  
［マーク］タイプ：［エリア］  
［マーク］カードの［色］：［ジャンル］  

8. 表を参考にビューを作成します。  

9. 次に、割合に変更します。［行］の［カウント（1.12_blues_music.csv）］を右クリックし、［簡易表計算］→［合計に対する割合］をクリックします。    

10. ジャンルごとに 100％ とした割合を計算するため、計算する範囲を変更します。［行］の［カウント（1.12_blues_music.csv）］を右クリックし、［次を使用して計算］→［Popularity（ビン）］をクリックします。  

11. 2 つのジャンルの積み上げを解除します。メニューバーから［分析］→［スタックマーク］→［オフ］をクリックします。

#### ポイント 
##### 9~11は何をしているのか？

手順9：合計に対する割合：数そのもの → 割合（％）に変える   
人気0〜10 → 20曲    
人気10〜20 → 30曲   

人気0〜10 → 40%      
人気10〜20 → 60%    

手順10：計算する範囲を変更: ジャンルごとに100％にしたい    
全ジャンルまとめて100％→BluesはBluesだけで100％・JazzはJazzだけで100％   

手順11：積み上げ解除:👉 棒を重ねるのをやめて、横に並べる

##### 人気0~10とはなにか

X軸のメモリ（右に行くだけ人気がある）  

人気0ー10　→　人気の点数低い（人気があまりない)        
人気90ー100　→　人気の点数が高い（人気がとてもある）  

<img width="1302" height="816" alt="スクリーンショット 2026-01-23 142936" src="https://github.com/user-attachments/assets/7bd3e798-20e6-493f-a455-649b847c2f7b" />

#### 練習問題13

都道府県コード一覧のデータ「1.13_prefecture_code.csv」と、「1.13_prefecture_price」フォルダ配下にある47都道府県ごとの不動産価格データを使用して、市区町村ごとの平均不動産価格を表す次のようなビジュアル表現を作成しましょう。  

・「Municipality」（市区町村）ごとの「Trade Price」（不動産価格）の平均を棒グラフで降順に表示  
・「Code」（コード）順に北海道から並べた「Jp Name」（都道府県の日本語表記）を「13, 東京都」でフィルター  
・不動産価格データ「Municipality Code」と都道府県コードデータの「Code」が対応。ただし、「Municipality Code」は5桁の数字の上2桁（47001なら47、1001なら1）と、「Code」が紐づく  

##### 解答

1. まず、47 都道府県のデータを組み合わせます。「1.13_prefecture_price」フォルダ下の［01.csv］に接続します。  
2. キャンバスに配置された［01.csv］をクリックし、［ユニオンに変換］をクリックします。  
3. ［ワイルドカード（自動）］タブをクリックします。  
4. ［OK］をクリックして画面を閉じます。ファイル名を指定しない場合、［01.csv］を含むフォルダ内のすべての CSV ファイルを対象に、すべてのデータを縦に組み合わせます。  
5. 次に、日本語で都道府県名を表示できるように、日本語のデータを持つ都道府県コード一覧データをリレーションシップで組み合わせます。左側のペインで［接続］にある［追加］をクリックし、［その他］から［1.13_prefecture_code.csv］に接続します。  
6. 左側のペインから［1.13_prefecture_code.csv］をキャンバスにドロップします。  
7. 不動産価格データの［Municipality Code］から、計算式で上 2 桁を取得します。データグリッドで、左側の［フィールドの選択］→［関係の計算を作成］をクリックします。

##### ＜疑問＞［Municipality Code］から、計算式で上 2 桁を取得しますはどういう意味か？

👉 市区町村コードの中から、都道府県を表す部分だけを取り出すという意味です。  
🔍 なぜ2桁を取る必要があるの？  

日本の行政コードは構造が決まっていて：  
例：13101  

これは：13 = 東京都（都道府県コード）101 = 市区町村コードになっています。  

今回：不動産価格データ → 市区町村コードしかない  都道府県コード一覧 → 都道府県コード（2桁）で管理されている  
👉 だから：市区町村コードの先頭2桁だけを取り出して、都道府県コードと一致させて結合したいという意図です。  

























   
