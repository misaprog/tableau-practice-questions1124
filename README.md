# tableau-practice-questions1124

#### 練習問題11

あるホテルの予約情報を含むデータから、ホテルの種類ごとに到着月別の宿泊率を比較するビジュアル表現を作成しましょう。  

・「Arrival Date Month」（到着月）ごとに、宿泊率を100%帯グラフで表示  
・宿泊率は、「Is Canceled」（キャンセルしたか）を使用して、「キャンセルしなかった割合」として計算  
・「Hotel」（ホテルの種類）ごとに表示  

##### 解答

1. まず、棒グラフを作成します。表を参考にグラフを作成します。  

［列］	［Hotel］、［カウント（1.11_hotel_bookings.csv）］  
［行］	［Arrival Date Month］  
［マーク］カードの［色］	［Is Canceled］  

※練習問題2の 4. から 7. を参照 → ［Is Canceled］をメジャーからディメンションへ移動

2. 次に、100％積み上げグラフに変更します。［列］の［カウント（1.11_hotel_bookings.csv）］を右クリックし、［簡易表計算］→［合計に対する割合］をクリックします。  
3. ［列］の［カウント（1.11_hotel_bookings.csv）］を右クリックし、［次を使用して計算］→［Is Canceled］をクリックします。  
4. 横軸を非表示にします。［列］の［カウント（1.11_hotel_bookings.csv）］を右クリックし、［ヘッダーの表示］をクリックしてチェックを外します。
5. 宿泊とキャンセルを左右逆に配置します。画面の右側にある色の凡例で項目をドラッグし、キャンセルを下、宿泊を上にします。
6. ［マーク］カードの［色］＞［色の編集］をクリックして、色を変更します。この図では、キャンセルの色を変更の際に、［キャンセル］の文字をダブルクリックして白色を選択しています。
7. ［OK］をクリックして画面を閉じます
8. ［マーク］カードの［色］をクリックして、枠線の色を変更します。
10. 割合を棒の中に表示します。［列］の［カウント（1.11_hotel_bookings.csv）］を［Ctrl］キーを押しながら［マーク］カードの［ラベル］にドロップします。割合が表示されない場合は、ビューの表示領域が狭い可能性があります。［ビュー全体］を選んでビューのサイズを調整したり、棒の幅を広げてみてください。

##### ポイント

<疑問>  
ホテルCSVを列に置くと何故シティホテルとリゾートホテルに自動的で分かれたのか？    
→CSVの構造が解っていなかったから  

##### ファイルの構造を理解する方法  
✅ Tableauで「構造」を一瞬で把握する方法（実務で一番使う）  

🔹 方法①：データソース画面を見る（最重要）  

Tableau下部の👉 ［データソース］タブ  
ここで：列名一覧/データ型（文字・数値・日付）/サンプル値  
が一気に見えます。

🔹 方法②：ディメンションをフィルターに置く  

たとえば hotel をフィルターに置くと：  
☑ City Hotel  
☑ Resort Hotel  
→ この列は カテゴリ分類用 と即判断できます。 

🔹 方法③：件数を棒グラフにする  

hotel を列、件数 を行に置くだけで：  
→ データの偏り・構造が一瞬でわかります。

<img width="1305" height="821" alt="スクリーンショット 2026-01-22 115105" src="https://github.com/user-attachments/assets/733786a4-2877-40af-bada-62ea13ed8dc9" />


#### 練習問題12

曲ごとに集計されたSpotifyのデータを使用し、ブルースとヒップホップの音楽ジャンルについて、人気スコアの分布を比較する次のようなビジュアル表現を作成しましょう。  

・「Popularity」（人気スコア）の割合の分布をエリアチャートで表示  
・「Popularity」は5%ごとにビンで集計  
・「blues」（ブルース）と「hiphop」（ヒップホップ）の各チャートを重ねて表示  

##### 解答

1. まず、2 つのデータを縦に組み合わせて 1 つのデータにします。
　フォルダ「1.12_music」にある［1.12_blues_music.csv］に接続します。  

2. 左側のペインから［1.12_hiphop_music.csv］をキャンバスの  
　［1.12_blues_music.csv］の下にドラッグし、［ユニオン］が表示されたらドロップします。  

3. ファイル名から音楽種類の文字を抜き出します。データグリッドの右端にある［テーブル名］を右クリックし、［分割］をクリックします。この［テーブル名］フィールドは、ユニオンしたことで自動的に追加されました。  

4. ［テーブル名－分割済み 1］のフィールド名をダブルクリックして、
　「ジャンル」に名前を変更します。  

5. Popularity を 5 ずつにビンでまとめます。［シート］に移動し、［データ］ペインの［Popularity］を右クリックし、［作成］→［ビン］をクリックします。  

6. ［ビンのサイズ］に「5」を入力します。  

7. ［OK］をクリックして画面を閉じます。  

［列］：［Popularity（ビン）］  
［行］：［カウント（1.12_blues_music.csv）］  
［マーク］タイプ：［エリア］  
［マーク］カードの［色］：［ジャンル］  

8. 表を参考にビューを作成します。  

9. 次に、割合に変更します。［行］の［カウント（1.12_blues_music.csv）］を右クリックし、［簡易表計算］→［合計に対する割合］をクリックします。    

10. ジャンルごとに 100％ とした割合を計算するため、計算する範囲を変更します。［行］の［カウント（1.12_blues_music.csv）］を右クリックし、［次を使用して計算］→［Popularity（ビン）］をクリックします。  

11. 2 つのジャンルの積み上げを解除します。メニューバーから［分析］→［スタックマーク］→［オフ］をクリックします。

#### ポイント 
##### 9~11は何をしているのか？

手順9：合計に対する割合：数そのもの → 割合（％）に変える   
人気0〜10 → 20曲    
人気10〜20 → 30曲   

人気0〜10 → 40%      
人気10〜20 → 60%    

手順10：計算する範囲を変更: ジャンルごとに100％にしたい    
全ジャンルまとめて100％→BluesはBluesだけで100％・JazzはJazzだけで100％   

手順11：積み上げ解除:👉 棒を重ねるのをやめて、横に並べる

##### 人気0~10とはなにか

X軸のメモリ（右に行くだけ人気がある）  

人気0ー10　→　人気の点数低い（人気があまりない)        
人気90ー100　→　人気の点数が高い（人気がとてもある）  

<img width="1302" height="816" alt="スクリーンショット 2026-01-23 142936" src="https://github.com/user-attachments/assets/7bd3e798-20e6-493f-a455-649b847c2f7b" />

#### 練習問題13

都道府県コード一覧のデータ「1.13_prefecture_code.csv」と、「1.13_prefecture_price」フォルダ配下にある47都道府県ごとの不動産価格データを使用して、市区町村ごとの平均不動産価格を表す次のようなビジュアル表現を作成しましょう。  

・「Municipality」（市区町村）ごとの「Trade Price」（不動産価格）の平均を棒グラフで降順に表示  
・「Code」（コード）順に北海道から並べた「Jp Name」（都道府県の日本語表記）を「13, 東京都」でフィルター  
・不動産価格データ「Municipality Code」と都道府県コードデータの「Code」が対応。ただし、「Municipality Code」は5桁の数字の上2桁（47001なら47、1001なら1）と、「Code」が紐づく  

##### 解答

1. まず、47 都道府県のデータを組み合わせます。「1.13_prefecture_price」フォルダ下の［01.csv］に接続します。  
2. キャンバスに配置された［01.csv］をクリックし、［ユニオンに変換］をクリックします。  
3. ［ワイルドカード（自動）］タブをクリックします。  
4. ［OK］をクリックして画面を閉じます。ファイル名を指定しない場合、［01.csv］を含むフォルダ内のすべての CSV ファイルを対象に、すべてのデータを縦に組み合わせます。  
5. 次に、日本語で都道府県名を表示できるように、日本語のデータを持つ都道府県コード一覧データをリレーションシップで組み合わせます。左側のペインで［接続］にある［追加］をクリックし、［その他］から［1.13_prefecture_code.csv］に接続します。  
6. 左側のペインから［1.13_prefecture_code.csv］をキャンバスにドロップします。  
7. 不動産価格データの［Municipality Code］から、計算式で上 2 桁を取得します。データグリッドで、左側の［フィールドの選択］→［関係の計算を作成］をクリックします。

##### ＜疑問＞［Municipality Code］から、計算式で上 2 桁を取得しますはどういう意味か？

👉 市区町村コードの中から、都道府県を表す部分だけを取り出すという意味です。  
🔍 なぜ2桁を取る必要があるの？  

日本の行政コードは構造が決まっていて：  
例：13101  

これは：13 = 東京都（都道府県コード）101 = 市区町村コードになっています。  

今回：不動産価格データ → 市区町村コードしかない  都道府県コード一覧 → 都道府県コード（2桁）で管理されている  
👉 だから：市区町村コードの先頭2桁だけを取り出して、都道府県コードと一致させて結合したいという意図です。  


8. 図を参考に、5 桁の Municipality Code の上 2 桁を取得するように式を組み立てます。  

INT([Municipality Code] / 1000)  
 
9. ［OK］をクリックして画面を閉じます。    
10. 都道府県コードデータは、［Code］を選択します。    
11. フィールドがユニオンとリレーションシップをしているため、パフォーマンスの観点からデータを抽出します。キャンバス右上の［抽出］をクリックします。 (省略）     
12. ［シート］をクリックします。    
13. 抽出ファイルを保存する場所を指定し、［保存］をクリックします。(省略）    
14. ［シート］に移動して、表を参考に棒グラフを作成します。    

[列］	［平均（Trade Price）］  
［行］	［Municipality］  
その他	降順で並べ替え  

15. フィルターを表示したとき、日本語の都道府県名が北海道から順に並ぶように、［Code］と［JP Name］を組み合わせたフィールドを作成します。［データ］ペインで、［Code］と［JP Name］を［Ctrl］キーを押しながらクリックして選択します。    
16. 選択したフィールドを右クリックし、［作成］→［結合済みフィールド］をクリックします。    
17. ［データ］ペインの［Code と JP Name（結合）］を右クリックし、［フィルターを表示］をクリックします。    
18. 画面右側に表示されたフィルターで、［▼］→［単一値（リスト）］をクリックし、「13, 東京都」を選択します。

#### ポイント　対応表の利用

都道府県コード一覧のデータと同様に、Municipality（市区町村）など他のフィールドも日本語と英語の対応表を用意すれば、一括で値を日本語に変換できます。    
この方法は、データ修正や別名付与としても役立ちます。また、作成した対応表は他のデータにも再利用できます。    

#### ポイント　フィルターの表示順

フィルターの値は、フィールドの既定の並べ替え順に表示されます。  
既定の並べ替え順は、［データ］ペインでフィールドを右クリックし、［既定のプロパティ］→［並べ替え］で変更できます。  
値の数が多い場合は、本問のように順序を表す列を含むデータと組み合わせることを検討しましょう。    

<img width="1312" height="821" alt="スクリーンショット 2026-01-26 113420" src="https://github.com/user-attachments/assets/8a44effd-ef67-4b13-8a09-e985b8387ced" />

#### 練習問題14

航空会社の顧客満足度調査データを使用し、満足度とその内訳を示す次のようなビジュアル表現を作成しましょう。  

・「Class」（クラス）ごとに「Satisfaction」（満足度）の平均を棒グラフで表示  
・「Satisfaction」は、「Satisfied」（満足）を 1、それ以外を 0 とする  
・5段階評価された各評価フィールド 14 項目の値の平均を折れ線グラフで重ねて表示  

##### 解答

1. フィールドをシェルフにドロップしたとき、合計ではなく平均で集計されるように変更します。［データ］ペインで評価項目の［Baggage Handling］を右クリックし、［Shift］キーを押しながら［Seat Comfort］までを選択します。
2. フィールドを右クリックし、［既定のプロパティ］→［集計］→［平均］をクリックします。  
3. メニューバーから［分析］→［計算フィールドの作成］をクリックします。  
4. 「満足度」という名前にして、図を参考に式を組み立てます。  

IIF([Satisfaction] = "Satisfied", 1, 0)  
 
5. ［OK］をクリックして画面を閉じます。  
6. 表を参考に棒グラフを作成します。  

［列］	［平均（満足度）］  
［行］	［Class］  
その他	　ヘッダーをドラッグしてBusiness、Economy Plus、Economy の順に並べ替え  

7. 二軸にします。［データ］ペインの［Baggage Handling］をビューの上側にドラッグし、黒い点線が表示されたところでドロップします。  
8. 上の軸を複合します。［データ］ペインにある［Check-in Service］から［Seat Comfort］までのフィールドをすべて選択します。  
9. ビューの上側にある［Baggage Handling］の軸にドロップします。  
10. ［マーク］カードの上側にある［平均（満足度）］で、マークタイプを［棒］にし、［色］に含まれている［メジャーネーム］を削除します。  
11. 評価項目のマークをビュー全体に見せるために、上の軸の範囲を変更します。上の軸を右クリックし、［軸の編集］をクリックして、［ゼロを含める］のチェックを外します。  
12. ［マーク］カードの下側にある［メジャーバリュー］で、マークタイプを［線］にします。また、それぞれの［マーク］カードで色やサイズを変更してみましょう。  

<img width="1316" height="825" alt="スクリーンショット 2026-01-27 104940" src="https://github.com/user-attachments/assets/6d846905-e279-4d11-92d8-1d94a7640139" />


#### 練習問題15

［列］	［曜日(Datetime)］  
［行］	［週(Datetime)］  
［フィルター］	　［年/月(Datetime)］  　
※［2024年12月］を選択、［単一値（リスト）］でフィルターを表示  
［マーク］カードの［テキスト］	［合計(Money)］  
［マーク］タイプ	［四角］  

##### ポイント  

単一リストでフィルターを表示の仕方  

フィルターにdetetaime月/年を入れる    
右上に表示されたフィルターペインの▼を押す  
単一（リスト)を入れる  


1. 表を参考にカレンダー形式のビューを作成します。  
2. メニューバーから［標準］→［ビュー全体］をクリックします。  
3. 最大値・最小値で色をつけます。メニューバーから［分析］→［計算フィールドの作成］をクリックします。  

4. 新しい計算フィールド「最大値・最小値」を作成し、図のように式を組み立てます。背景全体に色をつけるため、最大値、最小値をそれぞれ 1、-1 の連続の値に変換します。  

IF
WINDOW_MAX(SUM([Money])) = SUM([Money]) THEN 1
// 最大値は 1
ELSEIF
WINDOW_MIN(SUM([Money])) = SUM([Money]) THEN -1
// 最小値は -1
ELSE 0
// それ以外は 0
END

5. ［OK］をクリックして画面を閉じます  
6. ［データ］ペインから［最大値・最小値］を［マーク］カードの［色］にドロップします  
7. ［マーク］カードの［色］＞［色の編集］をクリックし、図を参考に色を変更します。  
8. ［OK］をクリックして画面を閉じます。
9. ［マーク］カードの［色］をクリックして、枠線の色を変更します。    

##### 枠線の変え方
色の中に枠線という項目があるのでそこで変更    

<img width="1314" height="833" alt="スクリーンショット 2026-01-27 115015" src="https://github.com/user-attachments/assets/dfc335c0-95aa-4d26-8e0a-096ca987a95f" />


#### 練習問題16

アニメの評価データを使用して、アニメの種類別で分布を把握するビジュアル表現を作成しましょう。  

・「Type」（アニメ種類）ごとに、「Rating」（評価）を0.2刻みのビンで集計し、ヒストグラムでアニメ作品数を表示  
・ヒストグラムなので、棒と棒は隣り合い余白を表示させない  

##### 解答

1. ビンを作成します。［データ］ペインの［Rating］を右クリックし、［作成］→［ビン］をクリックします。  
2. ［ビンのサイズ］に「0.2」を入力し、［OK］をクリックして画面を閉じます
3. 表を参考にビューを作成します。  

［列］	［Rating（ビン）］
［行］	［Type］	［カウント（1.16_anime.csv）］

4. 縦軸を調整します。縦軸を右クリックし、［軸の編集］をクリックします。  
5. ［範囲］の［各行または列の独立した範囲］をクリックします。これにより、棒グラフで棒の長さに合った軸の範囲となり、分布の形を比較しやすくなります。  
6. ［軸のタイトル］は何も表示しないように、文字を削除します。 (できないのでヘッダーの表示のチェックを外しました。)   
7. ［×］をクリックして画面を閉じます。 
8. ［列］の［Rating（ビン）］をクリックし、［連続］をクリックします。連続値にすると、連続値同士がつながるため、棒と棒の間に余白がなくなり、ヒストグラムに適する表現になります。  
9. ツールバーから［標準］→［ビュー全体］をクリックします。  
10. ［データ］ペインから［Rating（ビン）］を［フィルター］シェルフにドロップします。  
11. ［NULL］と［除外］を選択します。  
12. ［OK］をクリックします。  

<img width="1310" height="831" alt="スクリーンショット 2026-01-27 141204" src="https://github.com/user-attachments/assets/aeb277e3-a6f9-4782-a34b-4ae4444ff2ee" />


#### 練習問題17


2020年から2024年の億万長者の資産データを使用して、各年のランキングを表す次のようなビジュアル表現を作成しましょう。  

・各「Year」（年）で、「Full Name」（億万長者名）の「Net Worth (B)」（資産額）の合計をランキング表で表示  
・「Gender」（性別）で「Full Name」を色分け  
・マウスオーバーすることで、「Organization Name」（組織名）を表示  

##### 解答

1. 表を参考にビューを作成します。      

［列］	［Year］※不連続      
［マーク］カードの［テキスト］	［Full Name］        
［マーク］カードの［色］	［Gender］    　　  
［ツールヒント］	［Organization Name］    

2. 表にランキングの数字を付けて、ランキング表の枠を作成します。［データ］ペインから［Net Worth (B)］を［行］にドロップします。  
3. ［行］の［合計(Net Worth (B))］を右クリックし、［簡易表計算］→［ランク］をクリックします。  
4. ［行］の［合計(Net Worth (B))］を右クリックし、［表計算の編集］をクリックします。  
5. ［次を使用して計算］で［特定のディメンション］をクリックし、［Gender］と［Full Name］にチェックを入れます。各年で、［Gender］と［Full Name］の組み合わせの中でランキングを計算するよう指定しています。  
6. ［×］をクリックして画面を閉じます。
7. ［行］の［合計(Net Worth (B))］を右クリックし、［不連続］をクリックします。［行］や［列］に連続値を配置すると軸になるため、値を表示するために不連続に変換しています。  
8. ［マーク］カードの［色］＞［色の編集］や、［ツールヒント］をクリックして、色やツールヒントを編集します。

###### ポイント
［データソース］ページで表示するデータの行数  

［データソース］ページのデータグリッドでは、デフォルトで上位 100 行が表示されます。    
右上の［100］を変更すると、より多くの行を表示できます。例えば「1000」と入力して［Enter］キーを押すと、最大で 1000 行、または1000 行以内のデータソースであればすべての行が表示されます。    

<img width="1303" height="825" alt="スクリーンショット 2026-01-28 110505" src="https://github.com/user-attachments/assets/90532795-56cb-4d0a-9fca-5518ea7b8928" />

   
#### 練習問題18

日本政府観光局の訪日外客数データを使用して、外客数の年推移とその国別内訳を表す次のようなビジュアル表現を作成しましょう。  
ダウンロードして入手できるデータは、そのままでは分析に適さない場合が多いため、データを整理するテクニックが重要です。  

・「年」別の訪日外客数の合計を棒グラフで表示  
・「国」別に各棒をツリーマップで表現  

##### 解答

1. まず、2003 年から 2024 年のシートを 1 つにまとめます。［1.18_visitors_2003_2024.xlsx］に接続します。  
2. ［ユニオンの新規作成］をキャンバスにドロップします。  
3. ［ワイルドカード（自動）］タブをクリックします。この Excel が含むすべてのシートを対象として、各年のデータを縦に組み合わせます。
   
##### ポイント 
［ワイルドカード（自動）］タブをクリックすると　この Excel が含むすべてのシートを対象として、各年のデータを自動で縦に組み合わせます。

4. ［OK］をクリックして画面を閉じます。
5. ヘッダー部分をきれいに読み取らせます。左側のペインで［データインタープリターの使用］にチェックを入れます。

##### ポイント

データインタープリターとは何か
これは 「見出しが崩れているExcelを、Tableauに正しく表として読ませるための自動整形機能」 を使う、という意味です。  

6. 不要なフィールドを非表示にします。倍率や累計などは必要があればシート上で計算するので、元データ以外のフィールドは不要です。歯車のアイコンをクリックし、［フィールドの並べ替え］で［広から狭］をクリックします。(省略）    
7. 累計、年計、倍率、パス、F2 を選択して非表示にします。［累計］をクリック後、［Shift］キーを押しながら［パス］をクリック、次に［Ctrl］キーを押しながら［F2］をクリックします。  
9. フィールド名を右クリックし、［非表示］をクリックします。  
10. データを横方向から縦方向に変換します。［9月］をクリック後、［Shift］キーを押しながら［10月］を選択し、月の列をすべて選択します。  
11. 複数の列が選択された状態で右クリックし、［ピボット］をクリックします。  
12. フィールド名を変更します。フィールド名をダブルクリックして、［ピボットのフィールド名］を「月」、［ピボットのフィールド値］を「人数」に、［シート］を「年」に、［F1］を「国」に変更します。  
13. 不要な行をフィルターします。［データソース］ページ右上の［追加］をクリックします。  
14. ［データソースフィルターの編集］ダイアログで、［追加］をクリックします。  
15. ［国］をクリックし、［OK］をクリックします。  
16. ［フィルター］ダイアログの右下にある［除外］にチェックを入れます。  
17. 検索するテキストボックスに「計」と入力し、［Enter］キーを押します。  
18. ［すべて］をクリックします。  
19. ［総数］と［NULL］も、16. と同様にしてチェックを入れます。    
20. ［OK］をクリックして画面を閉じます。  
21. 続けて［OK］をクリックして画面を閉じます。  
22. キャンバス右上の［抽出］をクリックして、［シート］をクリックします。［保存］を促すウィンドウが出てきたら、保存する場所を指定して抽出ファイルを保存します。  
23. ［シート］に移動して、表を参考にビューを作成します。  

［行］	［年］  
［マーク］カードの［色］	［国］  
［マーク］カードの［サイズ］	［合計（人数）］

23. ツールバーから［標準］→［ビュー全体］や［幅を合わせる］をクリックします。  
